//
// MI functionality and Panel within orders
//-----------------------------------------

div {
	&#woocommerce-order-items, &#atum_order_items {
		
		// WooCommerce UI overrides
		.woocommerce_order_items_wrapper, .atum_order_items_wrapper {
			
			table{
				&.atum_order_items, &.woocommerce_order_items {
					
					tr {
						
						&.order-item-mi-panel {
							
							> td {
								border: none;
								padding: 0;
								background-color: transparent;
							}
							
						}
						
						&.with-mi {
							
							&.selected {
								> td {
									border-bottom: none;
								}
								+ .order-item-mi-panel > td {
									background-color: $wp-pink-light;
									
								}
							}
							
							.line_cost .split-input div.input {
								input, label {
									// WC disabled color
									color: #ccc;
								}
							}
							
							.need-help {
								position: relative;
								height: 20px;
								width: 100%;
								margin-top: 5px;
								
								.need-help-inner {
									position: absolute;
									white-space: nowrap;
								}
							}
							
							td {
								border-bottom-color: transparent;
							}
							
							.wc-order-item-sku {
								display: none;
							}
							
							.atum-order-item-sku {
								display: none;
							}
							
						}
						
						.edit-inventory {
							color: $success;
							height: 20px;
							width: 20px;
							display: inline-block;
							cursor: pointer;
						}
						
					}
				}
			}
		}
		
		// ATUM MI panel
		.order-item-mi-panel {
			
			.order-item-inventory .inventory-header {
				.edit {
					margin: 0.5em 0 0;
					font-weight: 400;
					display: none;
				}
			
			}
			
			&:not(.multi-price) {
				.set-mi-purchase-price {
					display: none;
				}
			}
			
			&.editing {
				.order-item-mi-wrapper {
					padding-right: 2.7em;
				}
				
				.order-item-inventory .inventory-header {
					
					.inventory-name {
						padding-top: 2px;
					}
					
					.stock {
						padding-top: 4px;
					}
					
					.atum-line-actions {
						padding-right: 0;
					}
					
					.edit {
						display: block;
					}
				}
			}
			
			.order-item-mi-wrapper {
				padding: 1.5em 2em 2em 2em;
				text-align: center;
				border-bottom: 1px solid $gray-100;
			}
			
			.order-item-inventory {
				position: relative;
				background-color: $wp-pink-lighter;
				border-radius: 4px;
				cursor: default;
				margin-bottom: 10px;
				border: 1px solid var(--gray-400);
				
				&:last-child {
					margin-bottom: 15px;
				}
				
				&.collapsed {
					.inventory-info {
						display: none;
					}
					
					.toggle-indicator {
						&:before {
							content: "\f140";
						}
					}
				}
				
				.inventory-header, .inventory-info {
					padding: $grid-gutter-width/3 $grid-gutter-width/2;
				}
				
				.inventory-header {
					color: $dark;
					display: flex;
					align-items: center;
					
					> div {
						padding: 0 1em;
						line-height: 1.5em;
						vertical-align: top;
						&:last-child {
							padding-left: 0;
						}
					}
					
					.inventory-name {
						white-space: nowrap;
						font-weight: bold;
						text-align: left;
						font-size: 15px;
						flex-grow: 1;
						padding-left: 0;
						
						.atum-inventory-supplier-sku {
							display: block;
							margin-top: 0.5em;
							color: #888;
							font-weight: normal;
							font-size: 0.92em !important;
						}
					}
					
					.atum-line-actions {
						text-align: right;
						padding-right: 0;
					}
					
					.toggle-indicator, .lnr {
						background: transparent;
						border: none;
						cursor: pointer;
						
						&:focus {
							outline: none;
						}
					}
					
					.delete-line {
						font-size: 16px;
						top: 12px;
						position: absolute;
						right: -32px;
						color: $secondary;
						border: 0;
						background-color: transparent;
						
						&:hover, &:focus {
							color: $danger;
							outline: none;
						}
					}
				}
				
				.inventory-info {
					overflow: hidden;
					
					.info-fields-wrapper {
						display: flex;
						border-top: 1px solid $gray-200;
					}
					
					.info-fields {
						text-align: left;
						color: $gray-600;
						font-size: 12px;
						line-height: 1.8;
						display: block;
						min-width: 35%;
					}
					
					h6 {
						text-align: left;
						font-size: 12px;
						margin-bottom: 6px;
						margin-top: $grid-gutter-width/2;
						width: 100%;
						color: $blue-dark;
						font-weight: bold;
					}
					
					.inventory-field {
						width: 100%;
						
						label {
							display: none;
						}
						
						&.bom-tree-field {
							height: 100%;
						}
					}
				}
				
			}
			
			&.editing {
				.inventory-header {
					align-items: flex-start;
				}
			}
			
		}
		
		.stock_available {
			background-color: $gray-600;
			color: $white;
			border-radius: 5px;
			padding: 2px 10px;
		}
		
		.stock{
			white-space: nowrap;
			
			.label {
				color: $gray-500;
				font-size: 12px;
			}
		}
		
		.order-item-icons {
			
			a {
				text-decoration: none;
				
				&:focus {
					box-shadow: none;
					outline: none;
				}
			}
			
			span {
				
				&.atmi-multi-inventory {
					font-size: 18px !important;
					color: $green;
				}
			}
		}
		
		.add-inventory {
			.lnr{
				font-size: 14px;
				position: relative;
				top: 1px;
				padding-right: 3px;
			}
		}
		
	}
	
	// Atum orders already have the style applied
	&#woocommerce-order-items table.woocommerce_order_items tbody tr.invalid {
		background-color: rgba( $wc-red-light, 0.5);
	}
}

.after-item-inventory {
	display: flex;
	align-items: center;
	justify-content: flex-end;
	margin-bottom: 10px;
}

.need-help {
	font-size: 12px;
}


// Add Product popup
.wc-backbone-modal {
	table {
		td {
			.mi-icon {
				display: inline-block;
				height: 16px;
				vertical-align: middle;
				margin-right: 4px;
			}
		}
	}
}